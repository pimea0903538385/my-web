<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://kit.fontawesome.com/45043c16df.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@2.7.10/dist/vue.js"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="crossorigin="anonymous"></script>
</head>
<body>
<form action="/UploadProduct" method="post" enctype="multipart/form-data">
  <div class="mb-3">
    <label  class="form-label">商品名稱</label>
    <input type="name"  name="ProductName" class="form-control" required>
  </div>
  <div class="mb-3">
    <label  class="form-label">商品描述</label>
    <input type="name"  name="ProductDescription" class="form-control" required>
  </div>
  <div class="mb-3">
    <label  class="form-label">商品價格</label>
    <input type="name" name="ProductPrice" class="form-control" required>
  </div>
  <div class="mb-3">
    <label  class="form-label">商品庫存數量</label>
    <input type="name" name="ProductAmount" class="form-control" required>
  </div>
  <div class="mb-3">
    <label for="formFileMultiple" class="form-label">選擇圖片</label>
    <input class="form-control" type="file" id="formFileMultiple" name="ProductImages" multiple required>
  </div>
  <button type="submit" class="  btn-lg btn-primary">上架</button>
</form>
<script>
  const files = document.querySelector('#formFileMultiple').files;

  // 創建 FormData 對象，用於將檔案和其他數據一起傳送到後端
  const formData = new FormData();

  // 將其他表單數據添加到 FormData 對象中
  formData.append('ProductName', '商品名稱');
  formData.append('ProductDescription', '商品描述');
  formData.append('ProductPrice', '商品價格');
  formData.append('ProductAmount', '商品庫存數量');

  // 遍歷檔案列表，將每個檔案轉換成 BASE64 字符串，然後添加到 FormData 對象中
  for (let i = 0; i < files.length; i++) {
    const file = files[i];
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = function () {
      const base64String = reader.result.split(',')[1];
      formData.append('ProductImages', base64String);
    };
  }

  // 使用 XMLHttpRequest 對象發送 POST 請求，將 FormData 對象傳送到後端
  const xhr = new XMLHttpRequest();

  xhr.open('POST', '/UploadProduct');
  xhr.send(formData);
  xhr.onreadystatechange = function() {
    if (xhr.status == 200) {
      // 上傳成功，顯示提示框並進行頁面跳轉
      alert('商品上傳成功！');
      window.location.href = '/index.html';
    }
  };
</script>
</body>
</html>